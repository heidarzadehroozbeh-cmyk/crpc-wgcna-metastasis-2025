<<<<<<< HEAD

=======
CRPC WGCNA metastasis 2025
==========================

This repository contains the reproducible R code used in the manuscript:

Mehrabi T, Heidarzadeh R, *et al.* (2025). Dysregulated key long non-coding RNAs TP53TG1, RFPL1S, DLEU1 in prostate cancer. *Advances in Cancer Biology – Metastasis* 13:100132.

The goal of this project is to:

- Download and preprocess the public microarray dataset **GSE74685** (castration-resistant prostate cancer metastases).
- Perform differential expression analysis (**Bone vs Visceral** metastatic sites).
- Build a WGCNA network and detect co-expression modules.
- Correlate modules with the metastatic site trait (Bone vs Visceral).
- Extract long non-coding RNA (lncRNA) candidates, including *TP53TG1*, *RFPL1S*, *DLEU1*.
- Export gene–module assignments, module–trait correlations, candidate lists, and example figures.

All analyses are implemented in R and organised as a small, self-contained pipeline.

---

Directory structure
-------------------

`crpc-wgcna-metastasis-2025.Rproj`  
RStudio project file (recommended entry point).

### `scripts/`

Main analysis scripts:

**Script 01_load_packages.R**  
Install and load required packages (*GEOquery*, *Biobase*, *limma*, *WGCNA*, *dynamicTreeCut*, *tidyverse*, etc.), and set global options.

**Script 02 - download & preprocess GSE74685.R**  
Download GSE74685 from GEO, extract the expression matrix and phenotype table, apply light filtering, and save:

- `data/GSE74685_expr_raw.rds`
- `data/GSE74685_expr_filtered.rds`
- `data/GSE74685_pheno.csv`

**Script 03 - DE analysis (Bone vs Visceral).R**  
Perform limma differential expression analysis between **Bone** and **Visceral** metastatic samples and export the DEG table:

- `results/GSE74685_DEG_Bone_vs_Visceral_limma.csv`

**Script 04 - WGCNA network and modules (GSE74685).R**  
Construct a weighted gene co-expression network with WGCNA, detect modules, compute module eigengenes, and correlate modules with the Bone/Visceral trait. Export:

- `results/GSE74685_WGCNA_gene_module_assignment.csv`
- `results/GSE74685_WGCNA_module_trait_correlations.csv`

and save WGCNA R objects in `data/` for downstream analyses:

- `data/GSE74685_WGCNA_datExpr.rds`
- `data/GSE74685_WGCNA_moduleColors.rds`
- `data/GSE74685_WGCNA_MEs.rds`

**Script 05 - Extract module genes & lncRNA candidates (GSE74685).R**  
Combine DEG results, WGCNA module information, and platform annotation to generate:

- full gene information table with module membership,
- filtered module candidate genes (e.g. hub genes in bone-associated modules),
- lncRNA-focused candidate lists (highlighting *TP53TG1*, *RFPL1S*, *DLEU1*).

Outputs include:

- `results/GSE74685_WGCNA_geneInfo_allProbes.csv`
- `results/GSE74685_WGCNA_moduleCandidates.csv`
- `results/GSE74685_WGCNA_lncRNA_candidates.csv`
- (optionally) `results/GSE74685_GPL_key_lncRNAs_from_paper.csv` for a sanity check list.

**(Optional) GPL annotation helper script**  
If present, this script queries the GPL platform, builds a clean annotation table, identifies lncRNA-like biotypes, and writes:

- `docs/GSE74685_GPL_annotation.csv`
- `docs/GSE74685_GPL_annotation_lncRNAs.csv`
- `results/GSE74685_GPL_key_lncRNAs.csv`

### `data/`

Processed expression matrices, phenotype table, and saved WGCNA objects.  
These files can be regenerated by re-running the pipeline and are therefore excluded from version control.

### `results/`

CSV outputs from the DE and WGCNA analyses:

- DEG tables,
- module–trait correlation tables,
- gene/module/lncRNA candidate lists,
- optional sanity-check tables for key lncRNAs.

### `figures/`

Key plots generated from the pipeline, for example:

- Sample clustering dendrogram for outlier detection.
- Scale-free topology and mean connectivity curves (soft-thresholding).
- Gene dendrogram with module colours.
- TOM heatmap (subset).
- Module–trait heatmap for the Bone trait.
- Module size distribution.

These figures correspond to those used in the manuscript and can be regenerated by re-running the scripts.

### `docs/`

Lightweight documentation tables, such as platform / GPL annotation files.

---

Requirements
------------

- R (≥ 4.2 recommended)

R packages:

- `GEOquery`
- `Biobase`
- `limma`
- `WGCNA`
- `dynamicTreeCut`
- `tidyverse` (e.g. `dplyr`, `readr`, `ggplot2`)

All required packages are loaded (and installed if missing) by `scripts/Script 01_load_packages.R`.

---

How to run the pipeline
-----------------------

1. Clone this repository or download it as a ZIP and extract it.
2. Open `crpc-wgcna-metastasis-2025.Rproj` in RStudio.
3. Run the scripts in the following order:

   1. `scripts/Script 01_load_packages.R`  
   2. `scripts/Script 02 - download & preprocess GSE74685.R`  
   3. `scripts/Script 03 - DE analysis (Bone vs Visceral).R`  
   4. `scripts/Script 04 - WGCNA network and modules (GSE74685).R`  
   5. `scripts/Script 05 - Extract module genes & lncRNA candidates (GSE74685).R`  

4. Outputs will be written to the `data/`, `results/`, and `figures/` directories.
5. Figures in `figures/` can be directly used in the manuscript or adapted for new analyses.

---

License
-------

Code in this repository is released under the **MIT License**.

The underlying expression data (**GSE74685**) remain subject to the original GEO / authors’ terms of use.

---

Author
------

**Dr Roozbeh Heidarzadehpilehrood**  
Human Geneticist – Transcriptomics & ncRNA biomarkers  
Contact: `heidarzadeh.roozbeh [at] gmail [dot] com`

---

Citation

If you use this code or parts of the pipeline, please cite both:

Mehrabi T, Heidarzadeh R, et al.
Dysregulated key long non-coding RNAs TP53TG1, RFPL1S, DLEU1 in prostate cancer.
Advances in Cancer Biology – Metastasis. https://doi.org/10.1016/j.adcanc.2025.100132

Heidarzadeh R. (2025).
heidarzadehroozbeh-cmyk/crpc-wgcna-metastasis-2025: First public release – CRPC WGCNA metastasis pipeline (v1.0.0).
https://doi.org/10.5281/zenodo.17830034

Code in this repository is released under the MIT License. The underlying expression data (GSE74685) remain subject to the original GEO / authors’ terms of use.





